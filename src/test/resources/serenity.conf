webdriver {
  base.url = "https://erail.in/"
}

headless.mode = false;

serenity {
  project.name = "Serenity BDD Project"
  test.root = "net.serenitybdd.demos.todos"
  tag.failures = "true"
  linked.tags = "issue"
  restart.browser.for.each = scenario
  logging = verbose
  #
  # Use these options to reduce the size of the reports
  #
  # Report on test durations
  report.test.durations = true
  take.screenshots=FOR_FAILURES
  # Store HTML source for each page
  # (can be: ALWAYS, FAILURES or NEVER)
//  store.html = FAILURES
}

// Default page configuration
home.page = "https://todomvc.com/examples/angular/dist/browser/#/all"

environment = "prod,edge"
environments {
  local {
    home.page = "http://localhost:8080/angularjs/#/"
  }
  prod {
    home.page = "https://todomvc.com/examples/angular/dist/browser/#/all"
  }
  chrome {
      webdriver {
          driver = chrome
          chromedriver.binary = "/usr/local/bin/chromedriver"
          autodownload = false
          capabilities {
              browserName = "chrome"
              acceptInsecureCerts = true
              "goog:chromeOptions" {
                  args = [
                      "--headless",                      # Required for CI unless you run with display
                      "--disable-gpu",                   # Necessary on Windows/CI
                      "--window-size=1920,1080",        # Helps avoid issues with responsive layouts
                      "--ignore-certificate-errors",
                      "--incognito",
                      "--disable-infobars",
                      "--disable-default-apps",
                      "--disable-popup-blocking",
                      "--no-sandbox",                   # Often required in containerized CI environments
                      "--disable-dev-shm-usage"         # Prevent crashes due to limited /dev/shm size
                  ]
                  prefs {
                      "download.prompt_for_download" = false
                      "download.default_directory" = "src/test/resources/downloads" # Replace with an absolute path for better reliability
                      "plugins.always_open_pdf_externally" = true
                  }
              }
          }
      }
  }
  edge {
      webdriver {
          capabilities {
              browserName = "MicrosoftEdge"
              "ms:edgeOptions" {
                  args = [
                      "test-type",
                      "ignore-certificate-errors",
                      "--inprivate",  # Correct argument for incognito mode in Edge
                      "--start-maximized",
                      "disable-infobars",
                      "disable-gpu",
                      "disable-default-apps",
                      "disable-popup-blocking"
                  ]
              }
          }
      }
  }
  firefox {
      webdriver {
          capabilities {
              browserName = "firefox"
              pageLoadStrategy = "normal"
              acceptInsecureCerts = true
              unhandledPromptBehavior = "dismiss"
              strictFileInteractability = true
              "moz:firefoxOptions" {
                  args = ["-private"]  # Use "-private" instead of "-incognito" for Firefox
                  prefs {
                      "javascript.options.showInConsole": false
                  }
                  log {
                      level = "info"
                  }
              }
          }
      }
  }
}